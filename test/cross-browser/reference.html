<!DOCTYPE html>
<html lang="en">
    <head>
        <!-- meta -->
        <meta charset="utf-8" />
        <title>rc-socket reference implementation</title>

        <!-- external script -->
        <script src="../../dist/rc-socket.js"></script>

        <!-- styles -->
        <!--<link rel="stylesheet" href="../node_modules/easy-build/node_modules/mocha/mocha.css" />-->
    </head>

    <!--<script src="http://cdnjs.cloudflare.com/ajax/libs/loglevel/1.4.0/loglevel.min.js"></script>-->

    <!-- content -->
    <div id="workboard" style="position: absolute;"></div>
    <div id="mocha">
        <input type="button" onclick="createRcSocket();" value="StartSocket"/>
    </div>

    <!-- traces -->
    <script>
        var childWin;

        var createRcSocket = function() {
            var child = window.open('', 'childLogger');
            childWin = child.window;

            if (!childWin.clientLogger) {
                childWin.clientLogger = {
                    buffer: [],

                    debug: function() {
                        childWin.clientLogger.buffer.push(
                            arguments['0'] + ' ' + arguments['1'] + ' ' + arguments['2']
                        );
                    }
                };
            }

            var rc = new RcSocket("ws://localhost:9998/");
            rc.logger = childWin.clientLogger.debug;
            rc.debug = true;
            return rc;
        };

        if (window.location.search.replace("?", "").length) {
            createRcSocket();
            childWin.clientLogger.debug('startsocket-immediate');
        }
    </script>

    </body>
</html>